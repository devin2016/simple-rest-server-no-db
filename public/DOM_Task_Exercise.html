<!DOCTYPE html>
<html>
<head>
<title>DOM Exercise</title> 
    <style type="text/css">
        body{
            
        }
        #left{
            float: left; 
            width: 245px; 
            min-height: 99px;
            border-right: 1px solid gray;
        }
        
        #right{
            width: 245px; 
            min-height: 100px;
            float: right; 
        }
        
        #main{
            width: 500px; 
            min-height: 100px;
            height: auto; 
            border: 1px solid gray;
            overflow: auto;
        }
        
        input{
            margin-bottom: 10px;
            margin-top: 10px;
        }
        
       #right p{
            margin: 0px;
            margin-left: 25px;
            padding: 5px 0px;
        }
        
        button{
            position: relative;
            top: 0px;
            left: 0px;
        }
    </style>
</head>
    <body>
        <div id="main">
            <div id="left"></div>
            
            <div id="right"></div>
        </div>
        
        <script type="text/javascript">
            //Create button object
            var btn = document.createElement("BUTTON");
            btn.appendChild(document.createTextNode("Add New Fruit"));
            
            //Append button to body
            document.body.appendChild(btn).appendChild(document.createElement("br"));
            
            //Add event listener to the button
            document.getElementsByTagName("button")[0].addEventListener("click", addNewFruit);
            
            /*
                Callback Function to prompt the user to enter a new fruit to the list
                at button click even
            */
            function addNewFruit(){
                var fruitName = prompt("Enter new Fruit: ");
                if(fruitName != "undefined" && doesntExist(fruitName)){
                    var inp = document.createElement("input");
                    inp.type = "checkbox";
                    inp.value = fruitName;
                    
                    //Create label for input
                    var spn = document.createElement("span");
                    spn.innerHTML = fruitName;
                    
                    var handle = document.getElementById("left");
                    
                    handle.appendChild(inp);
                    handle.appendChild(spn);
                    attachEvent(inp);
                    
                    handle.appendChild(document.createElement("br"));
                }
                else{
                    alert("Invalid Fruit Name Entered!!");
                }
            };
            
            /*
                check if fruit exists in the checkbox list
            */
            function doesntExist(fruitname){
                var test = document.getElementsByTagName("input");
                
                for(var i = 0; i < test.length ; i++)
                    if(test[i].value.toLowerCase() == fruitname.toLowerCase()){
                        return false;
                    }
                
                return true;
            };
            
            /*
            Attach click event to each new fruit objects
            */
            function attachEvent(obj){
                obj.addEventListener("click", clickCheckbox);
                
                //Text click event triggers clickCheckbox.
                obj.nextSibling.addEventListener("click", clickText);
            };
            
            /*
                Call back for checkbox click event
            */
            function clickCheckbox(){
                //Create or Delete corresponding tag from the right div
                var p = document.getElementById(this.value);
                
                //Create new node if it doesn't exist
                if(!p){
                    p = document.createElement("p");
                    p.id = this.value;
                    p.innerHTML = this.value;
                    document.getElementById("right").appendChild(p);
                    
                }
                else{
                    //Delete the node if it exists
                    document.getElementById("right").removeChild(p);
                }               
            };
            
            /*
                Clicking text next to input will fire the same event as above
            */
            function clickText(){
                this.previousSibling.click();
            };
            
            
        </script>
    
    </body>
    
</html>